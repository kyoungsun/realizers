# 신뢰성을 위한 테스트

### 1. 개요

- SRE는 시스템의 신뢰성에 대한 확신을 정량화해야 하고 이를 위해 대규모 시스템에 전통적인 소프트웨어 테스트 기법을 적용함
- 신뢰성 측정
    - 과거 신뢰성 : 과거 시스템 동작에 대한 모니터링 데이터를 분석하여 평가
    - 미래 신뢰성 : 과거 데이터로부터 예측을 통해 평가

### 2. 테스트의 역할

- 변경 관리 : 테스트는 변경 전후의 시스템 동등성을 입증하여 불확실성을 줄임
- 테스트 커버리지 : 코드베이스의 테스트 커버리지가 높을수록 변경으로 인한 신뢰성 저하의 위험이 감소함

### 3. 테스트와 평균 복구 시간(MTTR)의 관계

- 테스트의 한계 : 테스트 통과는 완전한 신뢰성을 보장하지 않지만, 실패한 테스트는 신뢰성 부족을 나타냄
- MTTR 감소 : 효과적인 테스트는 문제를 사전에 발견하여 MTTR을 줄이고, 이는 사용자 경험을 향상시킴

### 4. 소프트웨어 테스트의 유형

- 전통적 테스트
    - 단위 테스트(Unit Tests) : 개별 함수나 클래스의 정확성 검증
    - 통합 테스트(Integration Tests) : 여러 구성 요소의 상호 작용 검증
    - 시스템 테스트(System Tests) : 전체 시스템의 동작 및 성능 검증
- 프로덕션 테스트
    - 모니터링: 실시간 시스템의 동작을 지속적으로 확인
    - 프로덕션 프로브(Production Probes): 실제 환경에서 시스템의 특정 기능을 테스트하여 예상대로 동작하는지 확인

### 5. 테스트 환경의 중요성

- 의존성 관리 : 테스트 환경은 시스템의 다양한 의존성을 고려해야 함
- 테스트 인프라 : 효과적인 테스트를 위해 안정적이고 일관된 테스트 인프라가 필요

### 6. 자동화의 역할

- 자동화된 테스트 : 테스트 자동화는 신속한 피드백을 제공하여 개발 효율성을 높임
- 지속적 통합(CI) : 코드 변경 시마다 자동으로 테스트를 실행하여 문제를 조기에 발견

### 7. 프로덕션 환경에서의 테스트

- 프로덕션 프로브 : 실제 사용자 트래픽을 방해하지 않으면서 시스템의 특정 기능을 테스트
- 모니터링과 알림 : 프로덕션 환경에서의 지속적인 모니터링을 통해 이상 징후를 신속하게 감지하고 대응

### 8. 결론

- 지속적인 테스트 : 테스트는 일회성이 아닌 지속적인 과정으로, 시스템의 신뢰성을 유지하고 향상시키는 데 필수적
- 테스트 투자 : 테스트에 대한 투자는 장기적으로 시스템의 안정성과 사용자 만족도를 높이는 데 기여

---

## [구글 엔지니어는 이렇게 일한다](https://www.yes24.com/Product/Goods/109182479)에서 소개된 테스트 분류

### 1. 크기(Size)에 따른 분류

| 유형                       | 특징                                         | 장점                          | 예시                         |
|--------------------------|--------------------------------------------|-----------------------------|----------------------------|
| 작은 테스트 (Small Tests)     | - 단일 프로세스/스레드에서 실행 <br> - 외부 I/O 사용 없음     | - 빠른 실행 속도 <br> - 일관된 결과 보장 | 단위 테스트 (Unit Tests)        |
| 중간 크기 테스트 (Medium Tests) | - 여러 프로세스/스레드 활용 <br> - 로컬 네트워크 통신 가능      | - 모듈 간 상호 작용 검증             | 통합 테스트 (Integration Tests) |
| 큰 테스트 (Large Tests)      | - 여러 기기 및 외부 시스템과 연동 <br> - 전체 시스템 시나리오 검증 | - 실제 운영 환경에 가까운 테스트 가능      | 시스템 테스트 (System Tests)     |

### 2. 범위(Scope)에 따른 분류

| 유형                             | 특징                      | 장점                     | 예시                                                  |
|--------------------------------|-------------------------|------------------------|-----------------------------------------------------|
| 좁은 범위 테스트 (Narrow Scope Tests) | - 개별 함수·클래스 검증          | - 빠른 문제 원인 파악 가능       | 단위 테스트 (Unit Tests)                                 |
| 중간 범위 테스트 (Medium Scope Tests) | - 여러 모듈·컴포넌트 간 상호 작용 검증 | - 인터페이스 및 데이터 흐름 확인 가능 | 통합 테스트 (Integration Tests)                          |
| 넓은 범위 테스트 (Wide Scope Tests)   | - 전체 시스템 동작 검증          | - 사용자 시나리오 기반 검증 가능    | 시스템 테스트 (System Tests), 종단 간 테스트 (End-to-End Tests) |

### 3. 구글이 권장하는 테스트 비율

- 작은 테스트: 80% → 빠른 피드백 & 신뢰성 높음
- 중간 크기 테스트: 15% → 모듈 간 연동 검증
- 큰 테스트: 5% → 전체 시스템 시나리오 검증

### 4. 효과적인 테스트 전략

- 독립적 실행: 테스트 간 상호 의존성 제거
- 밀폐된 환경: 외부 요인의 영향을 최소화
- 빠르고 신뢰성 있는 피드백 제공
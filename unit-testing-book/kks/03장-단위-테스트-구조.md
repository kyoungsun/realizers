# 03장 단위 테스트 구조

## 단위 테스트를 구성하는 방법

* AAA 패턴 or Given-When-Then 패턴을 사용
* 여러 개의 준비, 실행, 검증 구절 피하기
* 테스트 내 if 문 피하기
  * 여러개의 테스트 케이스로 나눠서 검증할 것
* 준비 구절이 길면 오브젝트 마더와 테스트 데이터 빌더를 사용
* 실행 구절이 두 줄 이상인 경우 테스트 대상의 공개 API가 문제가 있을 수 있음
  * 클라이언트에 메소드 호출을 더 강요하면 안됨
* 상태 검증 시 모든 속성에 대해 검증문을 작성하기보다 `euals()`, `==` 연산자를 활용
* 준비, 실행, 검증은 빈 줄로 구분하고 복잡할 경우에만 주석을 추가

## 테스트 간 테스트 픽처스 재사용

* 테스트 생성자를 통해 픽처스를 초기화 하지 말 것
  * 테스트 간의 높은 결합도는 안티 패턴
  * 테스트 가독성을 떨어뜨릴 수 있음
* Junit의 경우 테스트 픽처스 생성을 지원하는 메소드를 제공함
  * `@BeforeAll` - 해당 테스트 클래스 시작 시 1번 실행
  * `@AfterAll` - 해당 테스트 클래스 종료 시 1번 실행
  * `@BeforeEach` - 해당 테스트 클래스에 있는 테스트 메소드를 실행하기 전에 1번 씩 실행
  * `@afterEach` - 해당 테스트 클래스에 있는 테스트 메소드를 실행 후 1번 씩 실행

## 단위 테스트 명명법

* `[테스트 대상 메서드]_[시나리오]_[예상 결과]`를 사용
* 엄격하게 위 구조를 지키는 것보다 고객이나 도메인 전문가에게 이해하기 쉽게 간단하게 변경할 수 있다면 간단하게 사용하는 것을 권장
* 테스트 이름에 밑줄 표시로 단어를 구분하고, 테스트 대상 메서드 이름은 넣지 말 것
* 매개변수화된 테스트로 테스트 코드의 양을 줄일 수 있음
  * Junit5에서 `@ParameterizedTest`를 사용하여 매개변수화된 테스트를 작성할 수 있음
  * 긍정 시나리오, 부정 시나리오는 분리하는게 경험상 좋았음
* 검증문 라이브러리를 사용한 테스트 가독성 향상
  * AssertJ를 Junit5와 같이 사용할 수 있음

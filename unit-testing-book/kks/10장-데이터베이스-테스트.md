# 10장 데이터베이스 테스트

### 데이터베이스 테스트를 위한 전제 조건

* 데이터베이스 스키마, 참조 데이터를 소스 코드처럼 형상 관리 툴로 관리해야함
    * 참조 데이터란 시스템이 동작하는데 필요한 기초 데이터를 말함
* 개발자마다 별도의 데이터베이스 인스턴스를 활용하여 테스트를 수행해야함
* 마이그레이션 기반 배포 방식을 활용하여 데이터베이스를 관리
    * 대표적인 툴로는 Flyway, Liquibase 등이 있음

### 데이터베이스 트랜잭션 관리

* 비즈니스 연산은 원자적으로 업데이트해야 데이터 모순을 방지할 수 있음
* 원자적으로 업데이트 하기위해 데이터베이스 트랜젝션에 의존하고 작업 단위 패턴을 사용
* 통합 테스트 진행 시 준비, 실행, 검증 구절에서 각각의 새로운 트랜잭션(작업단위)를 사용해야 동작 모순을 방지할 수 있음
    * 실제 운영환경과 최대한 비슷하게 동작하도록 구현해야함

### 테스트 데이터 생명 주기

* 통합 테스트는 순차적으로 실행하는 것이 좋음
* 병렬 실행에는 상당한 노력이 필요하지만 그럴만한 가치가 없음
* 테스트 실행 간데 남은 데이터는 준비 구절에서 정리하는 방법이 베스트
* SQLite와 같은 인메모리 DB를 사용하면 남은 테스트 데이터를 걱정할 필요 없지만 실제 운영환경과 다르게 동작할 수 있으므로 통합 테스트에서는 사용하지 말 것

### 질문하고 싶은 내용

* Q1. 공유 데이터베이스를 사용할 때 통합 테스트를 서로 분리할 수 없는 문제가 생겨서 통합 테스트를 순차적으로 실행하라고 하는데 공유 데이터베이스를 사용하지 않고 통합 테스트를 할 수 있는 방법은 없을까?
* Q2. 정말로 통합 테스트를 병렬로 실행시키는 것은 가치가 없는가?

  
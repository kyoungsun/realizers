# 04장 좋은 단위 테스트의 4대 요소

## 좋은 단위 테스트의 4대 요소

### 회귀 방지

* 신규 기능 개발 시 기존 기능에 문제가 없음을 보장해야함
* 기능이 실제 의도한 대로 동작하지 않지만 테스트는 통과하는 거짓 음성을 줄여야함

### 리팩터링 내성

* 테스트 케이스를 깨트리지 않고 기존 코드를 수정할 수 있어야함
* 기능이 실제로 의도한 대로 동작하지만 테스트는 실패하는 거짓 양성을 줄어야함
  * 거짓 양성을 줄이려면 테스트가 구현 세부사항이 아니라 최종 결과를 검증해야함

### 빠른 피드백

* 테스트 케이스를 실행하는데 시간이 오래 걸리면 더 자주 실행할 수 없어서 피드백을 받는 주기가 늦어질 수 있음

### 유지 보수성

* 테스트가 얼마나 이해하기 어려운가?
  * 테스트 코드를 일급 시민(first-class citizen)으로 취급
* 테스트가 얼마나 실행하기 어려운가
  * 테스트 실행에 필요한 외부 의존성을 최소한으로 줄여야함

## 이상적인 테스트란?

* 회귀 방지, 리팩터링 내성, 빠른 피드백 사이에서 절충을 찾아야함
* **리팩터링 내성은 0 아니면 1이기 때문에 항상 최대를 목표로하고 회귀 방지, 빠른 피드백 사이에서 절충을 찾아야함**

### 테스트 피라미드

* 엔드 투 엔드 테슽, 통합 테스트, 단위 테스트로 구성됨
* 가장 상위에 있는 엔드 투 엔드 테스트는 빠른 피드백 지표가 낮고 유지 보수가 어려우므로 가장 적은 비율을 유지해야함
* 가장 하위에 있는 단위 테스트가 더 많이 있는 것이 이상적임
* **비즈니스 규칙이나 알고리즘이 복잡하지 CRUD 작업에서는 엔드 투 엔드 테스트가 없고 통합 테스트와 단위 테스트의 수가 같을 수 있음**
  * 복잡하지 않은 코드에 대해 단위 테스트를 작성할 경우 간단한 테스트가 되어 쓸모 없는 코드가 될 수 있음
* 사용자 인터페이스 없이 하나의 외부 의존성만 연결하는 API 경우 엔드 투 엔드 테스트와 통합 테스트가 동일하다 할 수 있음

### 블랙박스 테스트 vs 화이트 박스 테스트

* **리팩터링 내성은 포기할 수 없으므로 블랙박스 테스트 방법을 사용해야함**
* 테스트 분석 시 화이트 박스 테스트 방식을 사용

### 질문하고 싶은 내용

* Q1. 회기 방지를 위해 거짓 음성(테스트는 통과하지만 실제 동작하지 않음)을 줄이는 테스트 케이스는 어떻게 만들 수 있을까?
* Q2. 테스트 코드를 일급 시민(first-class citizen)으로 취급하라는 말은 무슨 뜻인가?

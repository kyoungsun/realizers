# 11장 단위 테스트 안티 패턴

### 비공개 메서드 단위 테스트

* 테스트 코드가 구현 세부 사항과 결합되어 리팩터링 내성이 떨어짐
* 비공개 메서드가 너무 복잡하여 테스트하고 싶다면 추상화 누락이 있다는 뜻으로 클래스를 분리해야 함

### 비공개 상태 노출

* 비공개 필드를 변경하는 메소드를 테스트하기 위해서 비공개 필드를 공개로 변경하면 안됨
* 비공개 필드의 변경으로 인해 바뀌는 동작을 통해 우회적으로 테스트

### 테스트로 유출된 도메인 지식

* 테스트 준비 부분에서 테스트하려는 알고리즘을 다시 구현하면 안됨
* 예상값은 될 수 있으면 하드코딩하고 여의치 않을 때는 다른 계산 메서드를 활용하여 값을 획득해 사용해야함

### 코드 오염

* 테스트 코드만을 위한 구현을 코드에 추가하지 말 것
* 인터페이스를 사용하여 테스트 코드에서만 사용되는 구현체를 따로 작성하기

### 구체 클래스를 목으로 처리하기

* 일부 기능을 유지하기 위해 구체 클래스를 목으로 처리하면 단일 책임 원칙을 위반하게 됨
* 험블 객체 패턴을 적용하여 코드를 나누는게 바람직함
    * 도메인 로직이 있는 클래스와 프로세스 외부 의존성과 통신하는 클래스로 분리

### 잘못된 시간 데이터 처리

* 시간을 앰비언트 컨텍스트로 획득 시 숨어있는 의존성으로 인해 변경과 테스트가 어려워짐
    * 앰비언트 컨텍스트 : 정적 접근자를 통해 의존성을 획득하는 것
* 서비스나 일반 값으로 주입받고 가능하면 항상 일반 값으로 주입받는 것이 좋음
    * 생성자 주입이나 메서드 주입을 통해서 명시적으로 주입
# 05장 목과 테스트 취약

### 테스트 대역

* 테스트에서 사용하는 비제품 가짜 의존성의 모든 유형을 말함

### 목 vs 스텁

* 목은 외부로 나가는 상호 작용을 모방
  * SUT가 상태를 변경하기 위한 의존성을 호출하는 것
* 스텁은 내부로 들어오는 상호 작용을 모방
  * SUT가 입력 데이터를 얻기 위한 의존성을 호출하는 것
* **스텁으로 상호 작용을 검증하는 것은 안티 패턴**
  * 리팩터링 내성을 떨어트림
* 목과 스텁은 동시에 사용될 수 있지만 스텁으로 상호 작용을 검증하지 않는다는 규칙을 지켜야함

### CQS(Command Query Separation) 원칙

* 모든 메소드는 명령이거나 조회여야 함
* 명령은 부작용을 일으키고 어떤 값도 반환하지 않는 메서드
  * 명령을 대체할 때는 목을 사용
* 조회는 멱등성을 보장하는 메서드
  * 조회를 대체할 때는 스텁을 사용

### 식별할 수 있는 동작 vs 구현 세부 사항

* 아래 두 가지 중 하나라도 해당할 때 식별할 수 있는 동작이라 함
  * 클라이언트가 목표를 달성하는데 도움이 되는 연산을 노출
  * 클라이언트가 목표를 달성하는데 도움이 되는 상태를 노출
* 나머지는 구현 세부 사항
  * 구현 세부 사항은 비공개메서드로 감춰야 리팩터링 내성을 지킬 수 있음
* 시스템 통신에는 시스템 내부 통신과 시스템 간 통신이 존재함
* 시스템 내부 통신은 구현 세부 사항에 해당하므로 목을 사용해 검증 시 테스트가 취약해 질 수 있음

### 질문하고 싶은 내용

* Q1. 데이터베이스와 애플리케이션을 어떻게 하나의 시스템으로 취급할 수 있는가?
  * 피드백 속도를 저하시키지 않고 테스트 할 수 있는 방법이 존재하는가?


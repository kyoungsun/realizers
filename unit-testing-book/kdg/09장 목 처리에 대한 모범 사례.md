# 목 처리에 대한 모범 사례
<hr>

- 목은 SUT와 의존성 간의 상호작용을 모방하고 검사하는데 도움이 된다.
- 목은 8장에서 봤듯이 비관리 의존성에만 적용해야한다.(SMTP 서버, 메시지 버스) 

<br>

### 목의 가치를 극대화하기

<hr>

- 비관리 의존성에만 목을 사용하게끔 제한하는 것이 중요하지만 이는 목의 가치를 극대화하기 위한 첫번째 관문이다.
- 목의 가치를 높이기 위해서는 시스템 끝점에 있는 외부 의존성을 목처리를 한뒤에 테스트를 하면 회귀 방지를 높일 수 있다.
9.1.1에서 말하고 있는 예제코드는 목을 시스템 끝점에 연결하라는 의미

<br>

### 목 처리에 대한 모범 사례

<hr>

- 목은 통합 테스트만을 위한 것
  - 목은 통합 테스트만을 위한 것이며, 단위 테스트에서는 목을 사용하면 안된다.
  - 목은 비관리 의존성에만 해당하며 컨트롤러(또는 서비스)만 이러한 의존성을 처리하는 코드이기 때문에 여기에 한해서만 목을 적용해야 한다.
- 테스트당 목이 하나일 필요가 없다.
  - 단위라는 용어는 코드 단위가 아니라 동작 단위이다. 따라서 동작 단위를 구현하는데 필요한 코드의 양은 관계가 없다.
  - 동작 단위를 검증하는데 필요한 목의 수는 관계 없다.
  - 실제로 통합 테스트에서 사용할 목의 수를 통제할 수 없고, 목의 수는 운영에 참여하는 비관리 의존성 수에만 의존한다.
- 호출 횟수 검증하기
  - 비관리 의존성과의 통신에 관해서는 다음 두 가지 모두 확인하는게 중요하다.
    - 예상하는 호출이 있는가?
    - 예상치 못한 호출이 있는가?
- 보유 타입만 목으로 처리하기
  - 서드파티 라이브러리 위에 항상 어댑터를 작성하고 기본 타입 대신 해당 어댑터를 목으로 처리한다.

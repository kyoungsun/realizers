# 단위 테스트 안티 패턴
<hr>

### 비공개 메서드 단위 테스

- 비공개 메서드를 단위 테스트하고 싶은 유혹이 드는 순간!! 절대 하면 안된다.
- 테스트는 식별할 수 있는 동작(메서드)에 대해서만 테스트를 해야하는데 비공개 메서드를 테스트하면 세부 구현 사항에 의존하는 것이고 이는 리팩토링 내성을 저하시키는 원인이 된다.
- 비공개 메서드를 테스트 하고 싶은 유혹이 생길때 추상화의 레벨이 맞는지 확인할 필요가 있다.
  - 이는 비공개 메서드가 중요한 비지니스 로직을 가지고 있는 경우 클래스로 추출할 수 없는지 확인하고 클래스로 추출할 수 있다면 추출하여 테스트를 진행한다.
- 세부 구현 사항이 노출되면 캡슐화가 깨진다.

<br>

### 비공개 멤버변수 상태 노출

- private로 설정한 변수를 테스트하고 싶은 유혹이 드는 순간!! 우선 참는다.
- 클래스를 어떻게 사용하는지를 대신 살펴보고, 식별할 수 있는 동작(메서드)으로 테스트를 진행한다.

<br>

### 테스트로 유출된 도메인 지식

- 도메인 지식을 유출하는 것은 흔한 안티패턴이다.
- 도메인 지식을 유출하지 말고 SUT의 결과값과 기대값으로만 검증을 해라.

<br>

### 코드 오염

- 코드를 개발 환경과 운영 환경을 각각 테스트하기 위해 flag값을 사용한다면 이는 테스트 코드와 제품 코드가 혼재돼 유지비가 증가한다.
- 이를 테스트하기 위해서는 Stubbing을하여 테스트를 진행하면 해결된다.

<br>

### 구체 클래스를 목으로 처리하기

- 단일 책임원칙을 위반하므로 구체 클래스 대신 인터페이스를 목으로 사용하자.

<br>

### 시간 처리하기

- 메서드의 매개변수로 시간(LocalDate, LocalDatetime 등)을 넘기든 Stub을 사용하든 하자.

<br>

### 공유 해보면 좋을 의견들
<hr>

1. 비공개 메서드가 비지니스의 중요한 로직을 담당하고 있고, 다양한 의존성을 가지고 있을때 무엇을 기준으로 클래스를 추출하면 좋을까?
   - 최대한 비슷한 역할을 가지고 있는 의존성을 묶은 다음 클래스 추출 기법을 사용하여 리팩토링해야하는가?
